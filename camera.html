				<!DOCTYPE html>
				<html lang="en">
				<head>
				<meta charset="UTF-8">
				<title>Deposit</title>
				<meta name="viewport" content="width=device-width, initial-scale=1">
				
				<style>
				  body {
				    background:#f5f5f5;
				    margin:0;
				    font-family: Arial, sans-serif;
				    text-align:center;
				  }
				
				  h2 {
				    margin-top:25px;
				    color:#0d4b35;
				    font-size:24px;
				    font-weight:600;
				  }
				
				  /* --- CAMERA FULLSCREEN OVERLAY --- */
				  #cameraOverlay {
				    position: fixed;
				    top:0; left:0;
				    width:100%; height:100%;
				    background:black;
				    display:none;
				    justify-content:center;
				    align-items:center;
				    flex-direction:column;
				    z-index:1000;
				  }
				
				  #video {
				    width:100%;
				    max-height:100%;
				    object-fit:cover;
				  }
				
				  /* Guide Frame */
				  .guide-frame {
				    position:absolute;
				    width:80%;
				    height:45%;
				    border:3px solid rgba(255,255,255,0.9);
				    border-radius:12px;
				    top:28%;
				    left:10%;
				    pointer-events:none;
				  }
				
				  /* Timer display */
				  #timerText {
				    position:absolute;
				    top:30px;
				    font-size:26px;
				    color:white;
				    font-weight:bold;
				  }
				
				  /* Capture button */
				  #captureBtn {
				    position:absolute;
				    bottom:50px;
				    width:80px;
				    height:80px;
				    background:white;
				    border-radius:50%;
				    border:5px solid #ddd;
				  }
				
				  /* Preview Card */
				  #previewBox {
				    width:85%;
				    height:180px;
				    margin:20px auto;
				    background:#eee;
				    border-radius:10px;
				    display:flex;
				    justify-content:center;
				    align-items:center;
				    overflow:hidden;
				  }
				
				  #previewImg {
				    max-width:100%;
				    max-height:100%;
				  }
				
				  /* TD style buttons */
				  .td-btn {
				    width:85%;
				    background:#006644;
				    color:white;
				    padding:15px;
				    border:none;
				    font-size:18px;
				    border-radius:6px;
				    margin-top:10px;
				  }
				  .td-btn:active {
				    background:#004d33;
				  }
				
				  #memoInput {
				    width:85%;
				    padding:14px;
				    border-radius:6px;
				    border:1px solid #ccc;
				    margin-top:10px;
				    font-size:16px;
				  }
				</style>
				</head>
				<body>
				
				<h2>Deposit</h2>
				
				<!-- Image Preview -->
				<div id="previewBox">
				  <span>No image captured</span>
				  <img id="previewImg" style="display:none;">
				</div>
				
				<!-- Buttons -->
				<button class="td-btn" id="openCameraBtn">Capture</button>
				
				<input id="memoInput" placeholder="Memo (optional)" />
				
				<button class="td-btn" id="continueBtn">Continue</button>
				
				<!-- CAMERA FULLSCREEN -->
				<div id="cameraOverlay">
				  <video id="video" autoplay playsinline></video>
				  <div class="guide-frame"></div>
				  <div id="timerText">10</div>
				  <button id="captureBtn"></button>
				</div>
				
				<script>
				let stream;
				const overlay = document.getElementById("cameraOverlay");
				const video = document.getElementById("video");
				const previewImg = document.getElementById("previewImg");
				
				let timer = 10;
				let timerInterval;
				
				/* ------ Open Camera Full Screen ----- */
				document.getElementById("openCameraBtn").onclick = async () => {
				  overlay.style.display="flex";
				
				  stream = await navigator.mediaDevices.getUserMedia({
					  video: {
					    facingMode: "environment",
					    width: { ideal: 1280 },
					    height: { ideal: 720 }
					  }
					});
				
				  video.srcObject = stream;
				
				  // reset timer
				  timer = 10;
				  document.getElementById("timerText").textContent = timer;	
				
				  timerInterval = setInterval(()=>{
				    timer--;
				    document.getElementById("timerText").textContent = timer;
				
				    if(timer <= 0) {
				      takePhoto();
				    }
				  },1000);
				};
				
				/* ------ Manual Capture Button ----- */
				document.getElementById("captureBtn").onclick = () => takePhoto();
				
				/* ------ Take Photo Function ----- */
				function takePhoto() {
				  clearInterval(timerInterval);
				
				  // Canvas ( 2~3ë°°)
				  const canvas = document.createElement("canvas");
				  canvas.width = video.videoWidth * 1.2;
				  canvas.height = video.videoHeight * 1.2;
				
				  const ctx = canvas.getContext("2d");
				
				  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
				
				  //  crop ( 40%)
				  const cropWidth = canvas.width * 0.6;
				  const cropHeight = canvas.height * 0.4;
				  const cropX = (canvas.width - cropWidth) / 2;
				  const cropY = (canvas.height - cropHeight) / 2;
				
				  const cropCanvas = document.createElement("canvas");
				  cropCanvas.width = cropWidth;
				  cropCanvas.height = cropHeight;
				
				  cropCanvas.getContext("2d").drawImage(
				    canvas,
				    cropX, cropY, cropWidth, cropHeight,
				    0, 0, cropWidth, cropHeight
				  );
				
				  // Contrast & Light Correction 
				  let imgData = cropCanvas.getContext("2d").getImageData(0, 0, cropWidth, cropHeight);
				  let data = imgData.data;
				
				  for (let i = 0; i < data.length; i += 4) {
				    let r = data[i];
				    let g = data[i + 1];
				    let b = data[i + 2];
				
				    let gray = 0.299 * r + 0.587 * g + 0.114 * b;
				    
				    gray = gray < 128 ? gray * 0.8 : gray * 1.3;
				    gray = Math.min(255, Math.max(0, gray));
				
				    data[i] = data[i + 1] = data[i + 2] = gray;
				  }
				
				  cropCanvas.getContext("2d").putImageData(imgData, 0, 0);
				
				  const dataUrl = cropCanvas.toDataURL("image/png");
				
				  previewImg.src = dataUrl;
				  previewImg.style.display = "block";
				  document.querySelector("#previewBox span")?.remove();
				
				  overlay.style.display = "none";
				  stream.getTracks().forEach(t => t.stop());
				}
				
				
				
				
				/* ------ Continue Button -> Upload to Server ----- */
				document.getElementById("continueBtn").onclick = () => {
				  if(!previewImg.src) {
				    alert("Please capture a cheque image first.");
				    return;
				  }
				
				  const memo = document.getElementById("memoInput").value;
				
				  fetch("/uploadBase64", {
				    method:"POST",
				    headers:{ "Content-Type":"application/json" },
				    body: JSON.stringify({
				      image: previewImg.src,
				      memo: memo
				    })
				  })
				  .then(r=>r.json())
				  .then(data=>{
				    alert("Deposit Processed!\nRecognized: " + data.result);
				    window.location.href="/success";
				  })
				  .catch(err => alert("Upload failed: " + err));
				};
				</script>

				<div style="display:flex; align-items:center; justify-content:center; gap:15px; margin-top:10px;">
 				 <a href="/db" style="color:#006644; font-size:12px;">Records</a>
				</div>
			
				</body>
				</html>
